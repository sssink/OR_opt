# 车辆路径问题（VRPTW）题目

## **问题描述**
一家物流公司需要为一组客户提供配送服务。公司有一支配送车队，每辆车有固定的容量限制。每个客户有具体的服务时间窗口（即车辆必须在某一时间段内到达），以及特定的货物需求量。物流公司需要规划每辆车的配送路线，确保在满足客户时间窗口和车辆容量限制的前提下，最小化总行驶距离或总配送成本。你是该物流公司的运输调度员，需要为一批客户安排送货路线。已知以下信息：

### **车辆信息**
- 可用车辆数量：**50 辆/200辆（分别对应200/800个客户）**。
- 每辆车的最大载重：**200 单位**。
- 每辆车的行驶速度：**60公里/小时**。

### **客户信息**
- 每个客户的位置由 `(X, Y)` 坐标表示，其中：
  - `X` 表示横坐标，
  - `Y` 表示纵坐标。
- `CUST NO.` 表示客户编号，**0** 表示配送中心（仓库）。
- `DEMAND` 表示客户的需求量。
- `READY TIME` 表示该客户的最早可服务时间（以分钟为单位）。
- `DUE DATE` 表示该客户的最晚可服务时间（以分钟为单位）。
- `SERVICE TIME` 表示为该客户服务所需的时间（以分钟为单位）。

---
### **示例数据**
以下是示例客户的具体信息：

| CUST NO. | XCOORD. | YCOORD. | DEMAND | READY TIME | DUE DATE | SERVICE TIME |
|----------|---------|---------|--------|------------|----------|--------------|
|    0     |   70    |   70    |   0    |     0      |  1351    |      0       |
|    1     |   33    |   78    |   20   |    750     |   809    |     90       |
                                                    ······
---
## **数据集**
数据集可以从此处下载：
- 200个客户：[VRP Dataset 200](./homberger_200_customer_instances.zip)                          
- 800个客户：[VRP Dataset 800](./homberger_800_customer_instances.zip)

数据集格式为 txt 文件，包含以下字段：
- `cust_no`：客户编号。
- `xcoord`：横坐标。
- `ycoord`：纵坐标。
- `demand`：需求量。
- `ready_time`：最早可服务时间。
- `due_date`：最晚可服务时间。
- `service_time`：服务时间。

---
## **任务**
设计一个最优的车辆路径方案，满足以下条件：

1. 每个客户只能被一辆车服务一次。
2. 每辆车的总载重不能超过其最大载重（**200 单位**）。
3. 每辆车的行驶路线必须从配送中心出发并返回配送中心。
4. 必须在客户的时间窗口内进行服务（即 `READY TIME` 到 `DUE DATE` 之间）。
6. 最小化车辆数量（第一优先级）。
7. 在车辆数量相同的情况下，最小化总行驶距离（第二优先级）。


### **输出以下结果**
- 每辆车的路径（按顺序列出客户编号）。
- 每辆车的行驶距离(欧几里得距离)。
- 每辆车的总载重。
- 总行驶距离（所有车辆的总和）。

---



## **提示**
- 车辆的行驶距离可以根据 `(X, Y)` 坐标计算。
- 车辆行驶速度为恒定值（例如每分钟行驶 1 单位距离）。
- 时间窗口和载重限制是必须满足的硬约束。
- 可以使用求解器（推荐国内的晞德、杉数，也可以使用Gurobi、CPLEX、SCIP、Google OR-Tools等）。

---

## **示例输出**

### 以下是可能的输出格式：

```plaintext
Route for Vehicle 1:
  Customers: 0 -> 1 -> 0
  Distance: 85.5
  Total Demand: 20
  Total Time: 180

Route for Vehicle 2:
  Customers: 0 -> 2 -> 3 -> 0
  Distance: 120.3
  Total Demand: 150
  Total Time: 250

Total Distance for All Vehicles: 205.8
```
---

 **为了鼓励用deepseek等大模型辅助给出合适的解决方案，并生成完整的报告，以下是具体要求和评分标准：**

### **1. 报告要求**
- **问题分析**：对问题的详细分析和解释。
- **解决方案**：提供完整的解决方案，包括算法选择和实现。
- **时间复杂度证明**：对算法的时间复杂度进行证明或估算。
- **图表展示**：绘制相关用例实现的图表（例如车辆路径图、时间窗口分布图等）。
- **排版与美观**：报告排版整洁，图表美观。



---

### **2. Pipeline 设计评分**
- **复杂度计算**：对算法和实现的计算复杂度进行评估。
- **报告完整性**：检查报告是否包含所有必要部分（问题分析、解决方案、时间复杂度证明、图表等）。
- **图表美观与排版**：对图表的绘制质量和排版进行评分。
- **计算消耗评估**：根据算法消耗的计算资源打分。

---

## **评分标准**
- 时间复杂度证明（10 分）：是否对算法的时间复杂度进行了合理的分析和证明。
- 报告完整性（30 分）：报告是否包含所有必要部分（问题分析、解决方案、时间复杂度证明、图表等）。
- 图表美观与排版（10 分）：图表的绘制质量和排版是否整洁美观。
- 计算结果评估（20 分）：资源消耗越低（如减少车辆、缩短距离、降低能耗），评分越高，表示解决方案越好。
- 计算正确性（30 分）：算法是否合理，计算结果是否准确。




## **测试环境**
为了确保代码能够正常运行，请在以下测试环境中运行：

- **操作系统**：Windows 10 / macOS 12 / Ubuntu 20.04。
- **Python 版本**：Python 3.8 或更高版本。
- **依赖库**：`pandas`, `numpy`, `matplotlib`。  
  使用以下命令安装依赖库：
  ```bash
  pip install pandas numpy matplotlib
  ```
## **输入输出脚本示例**
以下是一个 Python 脚本示例，用于加载数据集并输出每辆车的路径和总距离：

### **输入脚本**
```bash
import pandas as pd

with open("VRPTW200.txt", "r", encoding="utf-8") as file:
    data = file.read()

# 打印数据集前 5 行
print(data.head())

# 车辆信息
vehicle_capacity = 200
num_vehicles = 50

# 这里可以添加你的算法实现
```
### **输出脚本**
```bash
# 假设已经计算出了每辆车的路径和总距离
routes = {
    "Vehicle 1": {"path": [0, 1, 0], "distance": 85.5, "demand": 20},
    "Vehicle 2": {"path": [0, 2, 3, 0], "distance": 120.3, "demand": 150},
}

# 输出结果
for vehicle, details in routes.items():
    print(f"{vehicle}:")
    print(f"  Path: {details['path']}")
    print(f"  Distance: {details['distance']}")
    print(f"  Total Demand: {details['demand']}\n")

# 计算总行驶距离 
total_distance = sum(details["distance"] for details in routes.values())
print(f"Total Distance for All Vehicles: {total_distance}")